{"version":3,"sources":["webpack:///./src/views/system/AdminUserEdit.vue?f0d1","webpack:///src/views/system/AdminUserEdit.vue","webpack:///./src/views/system/AdminUserEdit.vue?d5c0","webpack:///./src/views/system/AdminUserEdit.vue","webpack:///./src/assets/javascript/mixins_upload.js","webpack:///./src/views/system/AdminUserEdit.vue?17a3","webpack:///./node_modules/core-js/modules/es.function.name.js"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","staticClass","_v","_s","id","nativeOn","$event","type","indexOf","_k","keyCode","key","save","model","value","callback","$$v","$set","expression","uploadUrl","uploadHeaders","onSuccess","beforeUpload","avatar","on","staticRenderFns","name","mixins","mixins_upload","props","data","email","password","watch","$route","getUserItem","mounted","methods","res","url","component","computed","process","localStorage","getItem","uploadSuccess","icon","file","isJPG","isLt5M","size","$message","error","DESCRIPTORS","defineProperty","f","FunctionPrototype","Function","prototype","FunctionPrototypeToString","toString","nameRE","NAME","configurable","get","call","match"],"mappings":"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","file":"js/chunk-674e7d9c.63a005a0.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"user-edit\"}},[_c('el-card',{staticClass:\"box-card\"},[_c('h1',{staticClass:\"title\"},[_vm._v(_vm._s(_vm.id ? '编辑' : '新建')+\"管理员\")]),_c('el-input',{attrs:{\"placeholder\":\"请输入邮箱\"},nativeOn:{\"keydown\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.save($event)}},model:{value:(_vm.model.email),callback:function ($$v) {_vm.$set(_vm.model, \"email\", $$v)},expression:\"model.email\"}}),_c('el-input',{attrs:{\"placeholder\":\"请输入密码\",\"show-password\":\"\"},nativeOn:{\"keydown\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.save($event)}},model:{value:(_vm.model.password),callback:function ($$v) {_vm.$set(_vm.model, \"password\", $$v)},expression:\"model.password\"}}),_c('el-input',{attrs:{\"type\":\"text\",\"placeholder\":\"请输入名字\"},model:{value:(_vm.model.name),callback:function ($$v) {_vm.$set(_vm.model, \"name\", $$v)},expression:\"model.name\"}}),_c('el-upload',{staticClass:\"avatar-uploader\",attrs:{\"action\":_vm.uploadUrl,\"show-file-list\":false,\"headers\":_vm.uploadHeaders,\"on-success\":_vm.onSuccess,\"before-upload\":_vm.beforeUpload}},[(_vm.model.avatar)?_c('img',{staticClass:\"avatar\",attrs:{\"src\":_vm.model.avatar}}):_c('i',{staticClass:\"el-icon-plus avatar-uploader-icon\"})]),_c('div',{staticClass:\"save\"},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.save}},[_vm._v(\"保存\")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div id=\"user-edit\">\n    <el-card class=\"box-card\">\n      <h1 class=\"title\">{{ id ? '编辑' : '新建' }}管理员</h1>\n      <el-input\n        v-model=\"model.email\"\n        placeholder=\"请输入邮箱\"\n        @keydown.native.enter=\"save\"\n      ></el-input>\n      <el-input\n        placeholder=\"请输入密码\"\n        v-model=\"model.password\"\n        @keydown.native.enter=\"save\"\n        show-password\n      ></el-input>\n      <el-input type=\"text\" v-model=\"model.name\" placeholder=\"请输入名字\"></el-input>\n      <el-upload\n        class=\"avatar-uploader\"\n        :action=\"uploadUrl\"\n        :show-file-list=\"false\"\n        :headers=\"uploadHeaders\"\n        :on-success=\"onSuccess\"\n        :before-upload=\"beforeUpload\"\n      >\n        <img v-if=\"model.avatar\" :src=\"model.avatar\" class=\"avatar\" />\n        <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\n      </el-upload>\n      <div class=\"save\">\n        <el-button type=\"primary\" @click=\"save\">保存</el-button>\n      </div>\n    </el-card>\n  </div>\n</template>\n\n<script>\nimport { saveUser, updateUser, fetchUserItem } from '@/api/adminUser'\nimport mixins_upload from '@/assets/javascript/mixins_upload'\n\nexport default {\n  name: 'UserEdit',\n  mixins: [mixins_upload],\n  props: ['id'],\n  data() {\n    return {\n      model: {\n        email: '',\n        password: '',\n        name: '',\n        avatar: '',\n      },\n    }\n  },\n  watch: {\n    $route() {\n      if (this.id) {\n        this.getUserItem()\n      } else {\n        this.model.email = ''\n        this.model.password = ''\n        this.model.name = ''\n        this.model.avatar = ''\n      }\n    },\n  },\n  mounted() {\n    this.id && this.getUserItem()\n  },\n  methods: {\n    // 保存管理员\n    async save() {\n      const { email, password, name, avatar } = this.model\n\n      const id = this.id\n      if (!email) {\n        this.$message.error('邮箱不能为空')\n        return\n      }\n      if (!password) {\n        this.$message.error('密码不能为空')\n        return\n      }\n      if (!name) {\n        this.$message.error('名字不能为空')\n        return\n      }\n      if (!avatar) {\n        this.$message.error('请上传头像')\n        return\n      }\n      //根据id判断是新建还是编辑\n      let res\n      if (id) {\n        const { _id } = JSON.parse(localStorage.getItem('user'))\n        res = await updateUser({ id, email, password, name, avatar })\n        if (id == _id) {\n          localStorage.removeItem('user')\n          localStorage.removeItem('token')\n        }\n      } else {\n        res = await saveUser({ email, password, name, avatar })\n      }\n      // 该管理员已存在\n      if (res.status === 1) {\n        this.$message.error(res.msg)\n        return\n      }\n      this.$message.success(res.msg)\n      this.$router.push('/system/userList')\n    },\n    // 获取管理员详情\n    async getUserItem() {\n      let res\n      try {\n        res = await fetchUserItem({ id: this.id })\n      } catch (err) {\n        this.model.email = 'user-find-error'\n        this.model.password = ''\n        this.model.name = ''\n        this.model.avatar = ''\n      }\n      this.model.email = res.data.email\n      this.model.password = ''\n      this.model.name = res.data.name\n      this.model.avatar = res.data.avatar\n    },\n    onSuccess(res) {\n      this.model.avatar = res.data.url\n    },\n  },\n}\n</script>\n\n<style lang=\"stylus\" scoped>\n@import '../../assets/stylus/variable.styl';\n\n#user-edit {\n  .box-card {\n    width: 520px;\n    box-shadow: none;\n\n    .title, .el-input {\n      margin-bottom: 30px;\n    }\n\n    .title {\n      font-size: $font-s;\n    }\n\n    .el-input {\n      width: 70%;\n    }\n\n    .save {\n      margin-top: 10px;\n    }\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AdminUserEdit.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AdminUserEdit.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./AdminUserEdit.vue?vue&type=template&id=433d5208&scoped=true&\"\nimport script from \"./AdminUserEdit.vue?vue&type=script&lang=js&\"\nexport * from \"./AdminUserEdit.vue?vue&type=script&lang=js&\"\nimport style0 from \"./AdminUserEdit.vue?vue&type=style&index=0&id=433d5208&lang=stylus&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"433d5208\",\n  null\n  \n)\n\nexport default component.exports","export default {\n  computed: {\n    // 文件上传地址\n    uploadUrl() {\n      return process.env.VUE_APP_BASE_API ?\n        process.env.VUE_APP_BASE_API + '/upload/images' : '/admin/upload/images'\n    },\n    // 文件上传时的请求头\n    uploadHeaders() {\n      return { 'Authorization': localStorage.getItem('token') || '' }\n    }\n  },\n  methods: {\n    // 文件上传成功的回调函数\n    uploadSuccess(res) {\n      this.model.icon = res.data.url\n    },\n    // 文件上传之前的回调函数\n    beforeUpload(file) {\n      const isJPG = file.type === 'image/jpeg' || file.type === 'image/png';\n      const isLt5M = file.size / 1024 / 1024 < 5;\n\n      if (!isJPG) {\n        this.$message.error('上传图片只能是 JPG或PNG 格式!');\n      }\n      if (!isLt5M) {\n        this.$message.error('上传图片大小不能超过 5MB!');\n      }\n      return isJPG && isLt5M;\n    }\n  }\n}","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AdminUserEdit.vue?vue&type=style&index=0&id=433d5208&lang=stylus&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AdminUserEdit.vue?vue&type=style&index=0&id=433d5208&lang=stylus&scoped=true&\"","var DESCRIPTORS = require('../internals/descriptors');\nvar defineProperty = require('../internals/object-define-property').f;\n\nvar FunctionPrototype = Function.prototype;\nvar FunctionPrototypeToString = FunctionPrototype.toString;\nvar nameRE = /^\\s*function ([^ (]*)/;\nvar NAME = 'name';\n\n// Function instances `.name` property\n// https://tc39.github.io/ecma262/#sec-function-instances-name\nif (DESCRIPTORS && !(NAME in FunctionPrototype)) {\n  defineProperty(FunctionPrototype, NAME, {\n    configurable: true,\n    get: function () {\n      try {\n        return FunctionPrototypeToString.call(this).match(nameRE)[1];\n      } catch (error) {\n        return '';\n      }\n    }\n  });\n}\n"],"sourceRoot":""}