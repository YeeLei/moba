(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-674e7d9c"],{"085e":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"user-edit"}},[a("el-card",{staticClass:"box-card"},[a("h1",{staticClass:"title"},[e._v(e._s(e.id?"编辑":"新建")+"管理员")]),a("el-input",{attrs:{placeholder:"请输入邮箱"},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.save(t)}},model:{value:e.model.email,callback:function(t){e.$set(e.model,"email",t)},expression:"model.email"}}),a("el-input",{attrs:{placeholder:"请输入密码","show-password":""},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.save(t)}},model:{value:e.model.password,callback:function(t){e.$set(e.model,"password",t)},expression:"model.password"}}),a("el-input",{attrs:{type:"text",placeholder:"请输入名字"},model:{value:e.model.name,callback:function(t){e.$set(e.model,"name",t)},expression:"model.name"}}),a("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.uploadUrl,"show-file-list":!1,headers:e.uploadHeaders,"on-success":e.onSuccess,"before-upload":e.beforeUpload}},[e.model.avatar?a("img",{staticClass:"avatar",attrs:{src:e.model.avatar}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),a("div",{staticClass:"save"},[a("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("保存")])],1)],1)],1)},s=[],n=(a("b0c0"),a("96cf"),a("1da1")),o=a("ef80"),i=a("6db7"),l={name:"UserEdit",mixins:[i["a"]],props:["id"],data:function(){return{model:{email:"",password:"",name:"",avatar:""}}},watch:{$route:function(){this.id?this.getUserItem():(this.model.email="",this.model.password="",this.model.name="",this.model.avatar="")}},mounted:function(){this.id&&this.getUserItem()},methods:{save:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a,r,s,n,i,l,c,u,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e.model,r=a.email,s=a.password,n=a.name,i=a.avatar,l=e.id,r){t.next=5;break}return e.$message.error("邮箱不能为空"),t.abrupt("return");case 5:if(s){t.next=8;break}return e.$message.error("密码不能为空"),t.abrupt("return");case 8:if(n){t.next=11;break}return e.$message.error("名字不能为空"),t.abrupt("return");case 11:if(i){t.next=14;break}return e.$message.error("请上传头像"),t.abrupt("return");case 14:if(!l){t.next=22;break}return u=JSON.parse(localStorage.getItem("user")),d=u._id,t.next=18,Object(o["g"])({id:l,email:r,password:s,name:n,avatar:i});case 18:c=t.sent,l==d&&(localStorage.removeItem("user"),localStorage.removeItem("token")),t.next=25;break;case 22:return t.next=24,Object(o["f"])({email:r,password:s,name:n,avatar:i});case 24:c=t.sent;case 25:if(1!==c.status){t.next=28;break}return e.$message.error(c.msg),t.abrupt("return");case 28:e.$message.success(c.msg),e.$router.push("/system/userList");case 30:case"end":return t.stop()}}),t)})))()},getUserItem:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(o["c"])({id:e.id});case 3:a=t.sent,t.next=12;break;case 6:t.prev=6,t.t0=t["catch"](0),e.model.email="user-find-error",e.model.password="",e.model.name="",e.model.avatar="";case 12:e.model.email=a.data.email,e.model.password="",e.model.name=a.data.name,e.model.avatar=a.data.avatar;case 16:case"end":return t.stop()}}),t,null,[[0,6]])})))()},onSuccess:function(e){this.model.avatar=e.data.url}}},c=l,u=(a("9ff9"),a("2877")),d=Object(u["a"])(c,r,s,!1,null,"433d5208",null);t["default"]=d.exports},"0a19":function(e,t,a){},"6db7":function(e,t,a){"use strict";t["a"]={computed:{uploadUrl:function(){return"http://test.moba.ltd/admin/upload/images"},uploadHeaders:function(){return{Authorization:localStorage.getItem("token")||""}}},methods:{uploadSuccess:function(e){this.model.icon=e.data.url},beforeUpload:function(e){var t="image/jpeg"===e.type||"image/png"===e.type,a=e.size/1024/1024<5;return t||this.$message.error("上传图片只能是 JPG或PNG 格式!"),a||this.$message.error("上传图片大小不能超过 5MB!"),t&&a}}}},"9ff9":function(e,t,a){"use strict";var r=a("0a19"),s=a.n(r);s.a},b0c0:function(e,t,a){var r=a("83ab"),s=a("9bf2").f,n=Function.prototype,o=n.toString,i=/^\s*function ([^ (]*)/,l="name";r&&!(l in n)&&s(n,l,{configurable:!0,get:function(){try{return o.call(this).match(i)[1]}catch(e){return""}}})}}]);
//# sourceMappingURL=chunk-674e7d9c.63a005a0.js.map