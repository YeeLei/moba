{"version":3,"sources":["webpack:///./src/views/resources/ArticleEdit.vue?687a","webpack:///src/views/resources/ArticleEdit.vue","webpack:///./src/views/resources/ArticleEdit.vue?3e2c","webpack:///./src/views/resources/ArticleEdit.vue","webpack:///./src/views/resources/ArticleEdit.vue?375c"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","staticClass","_v","_s","id","model","value","callback","$$v","$set","expression","_l","item","key","_id","name","on","handleImageAdded","save","staticRenderFns","props","data","title","body","hot","categories","articleCate","watch","$route","fetchArticleItem","mounted","fetchArticleTwo","methods","components","VueEditor","component"],"mappings":"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","file":"js/chunk-147d97e6.6418dc8e.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"article-edit\"}},[_c('el-card',{staticClass:\"box-card\"},[_c('h1',{staticClass:\"title\"},[_vm._v(_vm._s(_vm.id ? '编辑' : '新建')+\"文章\")]),_c('el-form',{attrs:{\"label-position\":\"right\",\"label-width\":\"100px\"}},[_c('el-form-item',{attrs:{\"label\":\"标题\"}},[_c('el-input',{attrs:{\"placeholder\":\"请输入文章标题\"},model:{value:(_vm.model.title),callback:function ($$v) {_vm.$set(_vm.model, \"title\", $$v)},expression:\"model.title\"}})],1),_c('el-form-item',{attrs:{\"label\":\"所属分类\"}},[_c('el-select',{attrs:{\"multiple\":\"\",\"placeholder\":\"请选择\"},model:{value:(_vm.model.categories),callback:function ($$v) {_vm.$set(_vm.model, \"categories\", $$v)},expression:\"model.categories\"}},_vm._l((_vm.articleCate),function(item){return _c('el-option',{key:item._id,attrs:{\"label\":item.name,\"value\":item._id}})}),1)],1),_c('el-form-item',{attrs:{\"label\":\"热门\"}},[_c('el-switch',{model:{value:(_vm.model.hot),callback:function ($$v) {_vm.$set(_vm.model, \"hot\", $$v)},expression:\"model.hot\"}})],1),_c('el-form-item',{attrs:{\"label\":\"上传日期\"}},[_c('el-date-picker',{attrs:{\"type\":\"date\",\"format\":\"yyyy 年 MM 月 dd 日\",\"value-format\":\"timestamp\",\"placeholder\":\"选择日期\"},model:{value:(_vm.model.date),callback:function ($$v) {_vm.$set(_vm.model, \"date\", $$v)},expression:\"model.date\"}})],1),_c('el-form-item',{attrs:{\"label\":\"详情\"}},[_c('vue-editor',{attrs:{\"useCustomImageHandler\":\"\"},on:{\"image-added\":_vm.handleImageAdded},model:{value:(_vm.model.body),callback:function ($$v) {_vm.$set(_vm.model, \"body\", $$v)},expression:\"model.body\"}})],1)],1),_c('div',{staticClass:\"save\"},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.save}},[_vm._v(\"保存\")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div id=\"article-edit\">\n    <el-card class=\"box-card\">\n      <h1 class=\"title\">{{ id ? '编辑' : '新建' }}文章</h1>\n      <el-form label-position=\"right\" label-width=\"100px\">\n        <el-form-item label=\"标题\">\n          <el-input v-model=\"model.title\" placeholder=\"请输入文章标题\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"所属分类\">\n          <el-select v-model=\"model.categories\" multiple placeholder=\"请选择\">\n            <el-option\n              v-for=\"item in articleCate\"\n              :key=\"item._id\"\n              :label=\"item.name\"\n              :value=\"item._id\"\n            >\n            </el-option>\n          </el-select>\n        </el-form-item>\n        <el-form-item label=\"热门\">\n          <el-switch v-model=\"model.hot\"></el-switch>\n        </el-form-item>\n        <el-form-item label=\"上传日期\">\n          <el-date-picker\n            v-model=\"model.date\"\n            type=\"date\"\n            format=\"yyyy 年 MM 月 dd 日\"\n            value-format=\"timestamp\"\n            placeholder=\"选择日期\"\n          >\n          </el-date-picker>\n        </el-form-item>\n        <el-form-item label=\"详情\">\n          <vue-editor v-model=\"model.body\" useCustomImageHandler @image-added=\"handleImageAdded\">\n          </vue-editor>\n        </el-form-item>\n      </el-form>\n      <div class=\"save\">\n        <el-button type=\"primary\" @click=\"save\">保存</el-button>\n      </div>\n    </el-card>\n  </div>\n</template>\n\n<script>\nimport {\n  fetchArticleTwo,\n  saveArticle,\n  updateArticle,\n  uploadEditorFile,\n  fetchArticleItem,\n} from '@/api/resource'\nimport { VueEditor } from 'vue2-editor'\nexport default {\n  name: 'ArticleEdit',\n  props: ['id'],\n  data() {\n    return {\n      model: {\n        title: '',\n        body: '',\n        hot: false,\n        categories: [],\n      },\n      articleCate: [],\n    }\n  },\n  watch: {\n    $route() {\n      if (this.id) {\n        this.fetchArticleItem()\n      } else {\n        this.model.title = ''\n        this.model.body = ''\n        this.model.categories = []\n        this.model.hot = false\n      }\n    },\n  },\n  mounted() {\n    this.fetchArticleTwo()\n    this.id && this.fetchArticleItem()\n  },\n  methods: {\n    // 保存文章\n    async save() {\n      const { title, body, categories, hot, date } = this.model\n      const id = this.id\n      // 名字不能为空\n      if (!title) {\n        this.$message.error('文章标题不能为空')\n        return\n      }\n      if (!categories.length) {\n        this.$message.error('至少要选择一个分类')\n        return\n      }\n      if (!date) {\n        this.$message.error('上传日期不能为空')\n        return\n      }\n      if (!body) {\n        this.$message.error('文章详情不能为空')\n        return\n      }\n\n      //根据id判断是新建还是编辑\n      let res\n      if (id) {\n        res = await updateArticle({ id, title, body, categories, hot, date })\n      } else {\n        res = await saveArticle({ title, body, categories, hot, date })\n      }\n      // 该文章已存在\n      if (res.status == 1) {\n        this.$message.error(res.msg)\n        return\n      }\n      this.$message.success(res.msg)\n      this.$router.push('/resource/articleList')\n    },\n    // 获取文章二级分类\n    async fetchArticleTwo() {\n      const res = await fetchArticleTwo()\n      this.articleCate = res.data\n    },\n    // 获取文章详情\n    async fetchArticleItem() {\n      const res = await fetchArticleItem({ id: this.id })\n      this.model = res.data\n    },\n    // 富文本文件上传\n    async handleImageAdded(file, Editor, cursorLocation, resetUploader) {\n      const formData = new FormData()\n      formData.append('file', file)\n\n      const res = await uploadEditorFile(formData)\n      Editor.insertEmbed(cursorLocation, 'image', res.data.url)\n      resetUploader()\n    },\n  },\n  components: {\n    VueEditor,\n  },\n}\n</script>\n\n<style lang=\"stylus\" scoped>\n@import '../../assets/stylus/variable.styl';\n\n#article-edit {\n  .box-card {\n    width: 1000px;\n    margin: 0 auto;\n    box-shadow: none;\n\n    .title {\n      margin-bottom: 30px;\n      font-size: $font-s;\n    }\n\n    .el-form-item {\n      margin-bottom: 30px;\n    }\n\n    .save {\n      text-align: right;\n      margin-top: 30px;\n    }\n  }\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ArticleEdit.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ArticleEdit.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ArticleEdit.vue?vue&type=template&id=db33fc16&scoped=true&\"\nimport script from \"./ArticleEdit.vue?vue&type=script&lang=js&\"\nexport * from \"./ArticleEdit.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ArticleEdit.vue?vue&type=style&index=0&id=db33fc16&lang=stylus&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"db33fc16\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ArticleEdit.vue?vue&type=style&index=0&id=db33fc16&lang=stylus&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ArticleEdit.vue?vue&type=style&index=0&id=db33fc16&lang=stylus&scoped=true&\""],"sourceRoot":""}